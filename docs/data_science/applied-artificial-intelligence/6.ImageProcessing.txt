Анализ изображений и видео
1 Введение в компьютерное зрение
1.1 Введение
Наверное, сложно переоценить значимость зрительного восприятия для че-
ловека.Зрениенеобходимодлявыполненияпрактическивсехзадачвнашей
жизни, как повседневных, так и профессиональных. Поэтому, неудивитель-
но, что задача компьютерного зрения столь популярна и востребована. Спо-
собность компьютера "видеть"анализировать"визуальную информацию -
один из самых распространённых примеров искусственного интеллекта.
Поскольку человек так хорошо и эффективно воспринимает и обрабаты-
вает визуальную информацию, данные об окружающем нас мире мы часто
регистрируем и сохраняем в виде цифровых изображений и видео. Сегодня
камера есть в каждом мобильном телефоне, камеры встраиваются в быто-
вую и профессиональную технику. Мы можем снимать под водой, с воздуха,
из космоса. Камеры вводят в человеческое тело, прикрепляют к диким жи-
вотным.Объёмымультимедиаинформациирастутскаждойсекундой.Что-
бы с этой информацией сделать что-то полезное, нужно научить компьютер
обрабатывать и анализировать видео-данные, решать задачи, специфичные
для той или иной области.
Давайте посмотрим на некоторые примеры областей применения ком-
пьютерного зрения.
• Диагностика опухоли головного мозга по МРТ-снимкам (изображени-
ям, полученным при помощи магнитно-резонансной томографии).
• Автоматическое обнаружение подозрительных объектов с камер ви-
деонаблюдения.
• Большойспектрзадачдляавтономногоуправленияавтомобилем:рас-
познавание разметки на дороге, дорожных знаков, других участников
движения, и многие другие.
• Анализ спортивных матчей - например, распознавание точной пози-
ции мяча.
• Биометрические системы, как, например, разблокировка телефона по
лицу владельца.
1
• Перевод вывесок, указателей, меню в ресторане с иностранного языка.
• Визуальные системы контроля качества - одно из самых ранних и рас-
пространённых применений систем компьютерного зрения. Компью-
тер анализирует все ли составляющие детали на нужном месте.
• Ещё один пример - автоматизированные магазины Amazon Go, без
касс и продавцов. При входе каждый покупатель регистрируется при
помощиприложениянамобильномтелефоне,идальшекамерыследят
за ним по всему магазину, отмечая, что данный покупатель берет с
полок и складывает себе в сумку.
• И последний пример на этом слайде - применение компьютерного зре-
ния в сельском хозяйстве. Роботы и дроны на полях - реальность сего-
дняшнего дня. Роботы определяют степень зрелости урожая, предска-
зывают его объёмы, распознают наличие заболеваний, используются
для автоматической прополки, сбора урожая.
Это всего лишь несколько примеров использования возможностей ком-
пьютерного зрения. Мы вернёмся к более подробному обсуждению этих и
других приложений чуть позже. А сейчас давайте определим, что же такое
компьютерное зрение.
Компьютерное зрение /emdash.cyr это область науки, которая занимается алго-
ритмами и системами фиксации и анализа изображений и извлечения ин-
формации из видео-данных. Или, иными словами, машинами, которые мо-
гут видеть мир и воспринимать его так же, как человек. По аналогии со
зрительной системой человека, система компьютерного зрения состоит из
сенсора, фиксирующего изображение, и устройства извлечения информа-
ции из изображения. Камеры - это глаза системы компьютерного зрения, а
компьютер и алгоритмы анализа и обработки изображений - мозг. На входе
система компьютерного зрения, как и зрительная система человека, фикси-
рует изображение, а на выходе должна быть способна извлечь семантиче-
скую информацию, интерпретировать изображение. Например, понять, что
это - изображение сада, что какая-то часть изображения соответствует мо-
стику, а какая-то - деревьям, цветам. Людям это кажется простой задачей.
Но научить этому компьютер не просто.
В данном курсе мы будем уделять основное внимание второй, и на мой
взгляд основной, компоненте системы компьютерного зрения - алгоритмам
и методам анализа изображений и видео.
В литературе можно встретить разные определения компьютерного зре-
ния. Для примера приведем три.
• Computing properties of the 3D world from one or more digital images (by
Trucco and Veri). В этом определении подразумевается, что вне зави-
симости от того, есть мы или нет, существует какой-то окружающий
мир и его изображения, анализируя которые мы хотим что-то о нём
понять. Это определение через имитацию зрительной системы чело-
века. У нас есть сенсор /emdash.cyr глаза, у нас есть преобразующее устройство
2
/emdash.cyr мозг, и мы воспринимаем мир при помощи анализа тех картинок,
которые видим.
• Make useful decision about real physical objects and scenes based on the
sensed images by Shapiro). Это определение ближе к робототехнике.
Мы хотим принимать решения и делать выводы о реальных объек-
тах вокруг нас на основе изображений, которые уловили сенсоры. К
примеру, это определение идеально подходит под описание того, что
делает робот-пылесос. Он принимает решение о том, куда ему дальше
ехать и какой угол пылесосить на основании того, что он видит.
• The construction of explicit, meaningful decisions of physical objects from
images (by Ballard and Brown). Наиболее общее определение из трех.
Если опираться на него, мы хотим просто описывать явления и объ-
екты вокруг нас на основе анализа изображений.
Подытоживая, можно сказать, что компьютерное зрение сводится к из-
влечению значимой информации из цифровых изображений.
Что из себя представляет цифровое изображение? Существует несколь-
ко типов цифровых изображений, самым распространенным из которых яв-
ляются растровые изображения. Растровое черно-белое изображение - это
двухмерный массив чисел, или матрица пикселей. Каждый элемент массива
кодирует интенсивность света в соответствующей пространственной пози-
ции. Ноль соответствует чёрному цвету - у чёрного цвета нулевая интен-
сивность света. Как по массиву чисел компьютеру определить, что данное
изображение - это портрет Эйнштейна? Это непросто.
Итак, задача компьютерного зрения - извлечь значимую информацию
из цифрового изображения. Какую значимую информацию можно извлечь
из изображения?
• Первое - семантическую информацию. Ответить на вопрос, что изоб-
раженонакартинке,понятьсемантикусцены.Распознатьиклассифи-
цировать объекты, определить их свойства и отношения. Например,
распознать, что на фотографии слева изображён мужчина на мото-
цикле с двумя собаками. Идентифицировать личность этого мужчи-
ны, породу собак, модель мотоцикла.
Помимо семантической информации, важное значение имеет также метри-
ческая информация об объектах. Определение размеров объектов, рассто-
яния между ними и их взаимного положения - важная подзадача компью-
терного зрения. Метрическая информация необходима в робототехнике и
системах навигации, в задачах 3D моделирования по снимкам.
Область компьютерного зрения тесно связана с многими другими дисци-
плинами. На сегодняшний день, большинство задач компьютерного зрения
решается при помощи алгоритмов машинного обучения. Компьютерное зре-
ние также связано с когнитивной наукой, занимающейся моделированием
3
когнитивных систем; c нейронауками, занимающимися изучением нейрон-
ных процессов. Компьютерное зрение широко используется в робототехни-
ке,системакомпьютерногозрения-неотъемлемаякомпонентабольшинства
роботов. Информационный поиск, анализ и синтез речи - тоже связанные
дисциплины.
Обработка изображений, анализ изображений и компьютерная графика
- очень тесно связанные области. Некоторые относят все три дисциплины к
области компьютерного зрения.
В рамках курса мы будем говорить об алгоритмах обработки изображе-
ний. Именно они используются, когда мы повышаем контрастность, удаля-
ем цвет или шум, применяем фильтры и т.д. Любые преобразования изоб-
ражений, когда на входе и выходе алгоритма изображение /emdash.cyr это обработка
изображений.
Для анализа изображений характерно, имея на входе изображение, на
выходе получить некую модель или набор признаков. То есть по исходно-
му изображению вычислить некоторые числовые параметры, которые опи-
сывают это изображение. Например, гистограмму распределения уровней
серого цвета, или координаты и классы объектов. В анализе изображений
как результат мы получаем набор признаков.
Ещё одна смежная область /emdash.cyr компьютерная графика, в которой гене-
рируют изображение по модели или набору признаков.
Все это невозможно без использования знаний и алгоритмов из ещё це-
лого ряда областей, таких как распознавание образов и статистике. Также
можно сказать, что анализ изображений /emdash.cyr это частный случай анализа
данных, и под-область искусственного интеллекта. К смежной дисциплине
можно отнести и нейропсихологию /emdash.cyr для того чтобы понять, какие у нас
есть возможности и как устроено восприятие картинок, полезно понимать,
как эти задачи решает наш мозг.
Отсчётисториикомпьютерноезрения,какобластиисследований,приня-
то начинать с 60-х годов 20-го века. В качестве первой точки отсчёта часто
приводят студенческий летний проект в группе искусственного интеллекта
MIT 1966 года. Первые попытки обнаружения краёв и восстановления 3D-
формы для простых объектов, "мира игрушечных кубиков"(Roberts 1965).
В 1970-х годах сформировался основной понятийный аппарат в области
обработки изображений. Велись активные исследования алгоритмов обна-
ружения краёв, были предложены первые алгоритмы сопоставления стерео
и анализа оптического потока.
В 80-х годах большое внимание уделялось математическому аппарату
анализа изображений. Многие работы используют Марковские случайные
поля для формулировки задач компьютерного зрения, что позволяет рас-
сматривать эти задачи как задачи оптимизации. Сформировалась теория
уровней представления изображений. Одной из основных вех этого этапа
является книга Дэвида Марра /guillemotleft.cyrЗрение. Информационный подход к изуче-
нию представления и обработки зрительных образов/guillemotright.cyr.
В 90-х годах продолжают активно развиваться многие направления ком-
пьютерного зрения: определение формы объекта по движению, методы на
4
основеоптическогопотока,определениетрехмернойформыобъектапоизоб-
ражениямсразныхракурсов,сегментацияизображений(алгоритмыnormalized
cuts и mean shift). Возможно самым значимым результатом этого десяти-
летия стало близкое взаимодействие областей анализа изображений и ком-
пьютерной графики - накладывание текстуры с реального изображения на
3D модель, построение трехмерных моделей объектов по снимкам с раз-
ных ракурсов, и автоматическая генерация новых ракурсов этих объектов.
Первые примеры использования статистических методов - использование
метода главных компонент для распознавания лиц.
В 2000-е годы связь между компьютерным зрением и компьютерной гра-
фикой продолжила развиваться: построение панорам по нескольким сним-
кам,созданиеHDRизображенийпримерытакоговзаимодействия.Такжена
это десятилетие приходятся существенные сдвиги в алгоритмах распознава-
ния, классификации изображений, информационного поиска. Было предло-
жено большое количество методов извлечения признаков из изображений,
которые затем подавались на вход алгоритмам машинного обучения для
решения задач распознавания и классификации.
В последнем десятилетии несомненно самой значительной вехой в ком-
пьютерномзрениисталоиспользованиеалгоритмовглубокогообучения(deep
learning). Рост объёмов данных и развитие аппаратного обеспечения поз-
волили использовать эти вычислительно сложные алгоритмы, которые за
несколько лет привели к большому прогрессу во всех задачах компьютерно-
го зрения. До методов глубокого обучения системы компьютерного зрения в
лучшем случае работали в контролируемой среде, когда можно отрегулиро-
вать освещение, камеру, положение объекта, и т.п. В естественных условиях
(неконтролируемойсреде)был огромныйразрывв точностираспознавания.
Однако за последние несколько лет удалось добиться большого прогресса
благодаря использованию методов глубокого обучения.
Нонесмотрянапрогресспоследнихлет,мыдосихпорводимавтомобили
самостоятельно, и даже к системам видеонаблюдения часто должен быть
приставлен человек. Почему? Одна из ключевых проблем /emdash.cyr семантический
разрыв.
Человек, глядя на картинку, понимает её семантику. Компьютер же по-
нимает цвет пикселей, умеет выделить текстуру и в конечном счёте отли-
чить кирпичную стену от ковра и распознать на фотографии человека, но
определить намерения человека по выражению его лица, позе машина ещё
может.
Помимо семантического разрыва, есть ещё ряд сложностей, с которыми
сталкиваются разработчики систем компьютерного зрения.
• Один и тот же объект будет может выглядеть очень по-разному при
различном освещении
• Изображение может быть очень разным в зависимости от позы модели
• Фоновый шум и маскировка
5
• Перекрытия
• Внутриклассовая изменчивость
• Ракурс, точка съёмки
1.2 Примеры практического применения
Мыобсудили,чтотакоекомпьютерноезрениеипочемуэтосложно.Давайте
теперь рассмотрим несколько областей применения анализа изображений и
видео чуть более детально.
1.2.1 Медицина
Одной из основных (и самых первых) областей применения анализа изобра-
жений является медицина. Первые попытки автоматически анализировать
медицинские снимки при помощи компьютера были предприняты на за-
ре компьютерного зрения. И сегодня эта область остаётся одной из самых
востребованных.
Медицинские изображения являются важным источником информации
о внутренних органах человека. Они активно используются для диагности-
ки, при планировании и проведении операций, для индивидуального моде-
лирования последствий операций.
Существует множество способов получения медицинских снимков. Изоб-
ражения получают при помощи электромагнитного излучения, рентгена,
ультразвука, компьютерной томографии (КТ), магнитно-резонансной томо-
графии(МРТ).Такоемногообразиетакжеговоритотом,наскольковажной
является визуальная информация в медицине. Большинство медицинской
техники, которая используется для получения медицинских снимков, об-
ладает встроенными возможностями автоматической обработки и анализа
изображений.
Компьютерный анализ медицинских изображений применим букваль-
но во всех областях медицины. Обнаружение переломов на рентгеновских
снимках костей, анализ снимков грудной клетки для диагностики лёгочных
заболеваний (например, пневмонии), анализ кровеносных сосудов при по-
мощи ангиографии, обнаружение раковых клеток, диагностика мозга, моде-
лирование зубов. Широкий круг задач в анализе медицинских изображений
связан с дерматологией. Список можно продолжать очень долго.
На слайде примеры рентгеновский изображений.
• Рентген кисти руки.
• Рентген грудной клетки.
• Ангиограмма аорты. Для получения ангиограммы в артерию или вену
вводят катетер, который продвигается в вдоль сосуда, пока не достиг-
нет обследуемой зоны. Затем через катетер впрыскивается контраст-
ное вещество, хорошо поглощающее рентгеновские лучи. Благодаря
6
этому усиливается контраст рентгеновского изображения, что позво-
ляет лучше определять аномалии кровоснабжения или места закупор-
ки сосудов.
• Компьютерная томограмма головы.
Какого типа алгоритмы обычно используются для анализа медицинских
снимков? По снимкам можно выявлять аномалии /emdash.cyr отличается ли снимок
данного пациента от снимка здорового человека?
При помощи алгоритмов классификации можно проводить диагностику
заболеваний. Если у вас есть база снимков пациентов и известно, что первая
аномалия встречается у здоровых людей, а вторая означает, что человек бо-
лен раком, то, основываясь на подобии изображений, можно помочь врачам
с диагностикой заболеваний.
Анализ изображений используется для индивидуального моделирования
организма и предсказания последствий лечения. Хотя мы все и похожи,
каждый организм устроен индивидуально. Например, при помощи модели-
рования зубов пациент может увидеть, как именно его зубы будут меняться
от недели к неделе, если поставить брекеты. Другой пример - моделирова-
ние последствий операции шунтирования кровеносного сосуда. Если чело-
веку требуется соединить разорванный сосуд шунтом, то определить, где
его ставить можно смоделировав по снимку кровеносную систему именно
этого пациента и /guillemotleft.cyrвставив/guillemotright.cyr шунт в этой модели. Так мы получим возмож-
ность увидеть, как изменится кровоток, и предсказать, как пациент будет
себя чувствовать при разных вариантах проведения операции.
Анализ изображений незаменим для роботизированной хирургии, для
неинвазивных и малоинвазивных операций, которые все больше и больше
заменяют открытые операции. Например, операции на мозге без вскрытия
черепа - удаление опухолей при помощи сфокусированного ультразвука.
Или различные операции с использованием эндоскопических инструментов
и дистанционного управления этими инструментами. При таких операциях
инструменты вводятся в тело через кожу или через анатомические отвер-
стия. Операция проводится при непрямом наблюдении внутренних органов
через инструменты, введённые в тело. И алгоритмы обработки и анализа
изображений помогают хирургам видеть и оперировать.
1.2.2 Промышленность
Ещё одна очень востребованная область применения анализа изображений
- системы контроля качества на производстве. Для данной прикладной за-
дачи часто используют изображения, регистрируемые в видимом диапазоне
(т.е. при помощи обычных оптических камер), и изображения, получаемые
при помощи электронного микроскопа.
Компьютерное зрение используется для автоматического контроля вы-
пускаемой продукции давно. Все примеры на слайде из книги 1992 года
издания.
7
• Контроль наличия всех компонент на плате контроллера дисковода
CD-ROM . Чёрный квадрат в правой верхней части демонстрирует
отсутствует микросхемы.
• Контроль наличия всех таблеток в упаковке.
• Контроль за уровнем жидкости в бутылках.
• Контроль за качеством пластмассы - на данном изображении пласт-
массовая деталь с недопустимым количеством пузырьков воздуха. Об-
наружение подобных аномалий составляет важную область промыш-
ленного контроля различных материалов, например тканей и дерева.
• Контроль за качеством кукурузных хлопьев - по цвету и наличию
подгоревших хлопьев.
Первые алгоритмы работали на основе большого количества эвристик и
правил. Алгоритмы создавались под определённое расположение камеры,
под определённый продукт. Так что создание и внедрение таких автомати-
зированных систем контроля качества было оправдано только для больших
производственных линий. Сегодня все больше и больше систем контроля
качества используют машинное обучение и искусственные нейронные сети.
1.2.3 Системы видеонаблюдения
Ещё одна прикладная область, где необходимы алгоритмы анализа изобра-
жений и видео, это системы видеонаблюдения. Сегодня камеры наблюдают
за нами повсюду: в аэропортах, на вокзалах, в метро, в магазинах, просто
на улицах. При таком объёме видеоданных без автоматизированных систем
анализа видеоряда не обойтись. Большинство камер устанавливаться для
обеспечения безопасности. Системы видеораспознавания позволяют опера-
тивно распознать скопления людей, идентифицировать и зафиксировать
факты их неадекватного движения (драки, падения, хаотичное движение,
резкое ускорение, пересечение запрещённой зоны), обнаружить в контроли-
руемой зоне оставленные или исчезнувшие предметы, выявить задымление
или открытый огонь. Задачи по обнаружению подозрительных предметов
или подозрительного поведения не так просты. Их сложность в том, что
часто нельзя заранее дать описание того, что является подозрительным
предметом. Невозможно предоставить все возможные примеры аномаль-
ного поведения. Поэтому часто в таких системах моделируют нормальное
поведение, и распознавание аномалий устроено на выявлении отклонений
от нормы.
Помимо охранных целей, системы видеонаблюдения часто используют-
ся для изучения поведения людей. Например, при помощи установленных
камер в магазине можно определить наиболее популярные отделы магазина
и использовать эту информацию для более удобной планировки расположе-
ния товаров.
8
Системы видеонаблюдения позволяют автоматически собирать плату за
проезд по платному участку дороги, штрафовать за превышение скорости,
наблюдать за животным миром. Список задач бесконечен!
1.2.4 Биометрия
Ещё одним направлением, активно использующим компьютерное зрение,
являются биометрические системы идентификации личности. Такие систе-
мы основаны на измерении уникальных биологических и физиологических
характеристик, индивидуальных для каждого человека. Иногда эти харак-
теристики ещё называют биологическим кодом человека.
Преимущество биометрических систем идентификации, по сравнению с
традиционными(например,PIN-кодовымисистемамиилисистемамидосту-
па по паролю), заключается в том, что идентифицируется не какой-то внеш-
ний предмет, принадлежащий человеку, а собственно сам человек. Анали-
зируемые характеристики неразрывно связаны с человеком, их невозможно
потерять, передать, забыть и крайне сложно подделать. К тому же эти ха-
рактеристики практически не подвержены износу и не требуют замены или
восстановления.
Средиосновныхбиометрическихтехнологий,работающихнаосновеком-
пьютерного зрения - распознавание личности по отпечаткам пальцев, гео-
метриилица,геометриикистируки,радужнойоболочкеилисетчаткеглаза,
геометрии рисунка вен, по подписи и др.
Первые биометрические системы были достаточно дорогими и требо-
вали значительных вычислительных ресурсов. Сегодня мы разблокируем
компьютеры и телефоны по отпечатку пальца или геометрии лица.
Приведу ещё одну нашумевшую в СМИ историю, связанную с задача-
ми биометрии. В Википедии даже есть статья, посвящённая этой истории.
В 80-х годах фотограф National Geographic сфотографировал неизвестную
афганскую девочку. Фотография стала очень известной после того, как по-
явилась на обложке журнала National Geographic в июне 1985 года. По-
скольку личность девочки была неизвестна, фотографию называли просто
/guillemotleft.cyrАфганской девочкой/guillemotright.cyr (Afghan Girl). Фотографию иногда сравнивают с
портретом Моны Лизы кисти Леонардо да Винчи и называют /guillemotleft.cyrАфганской
Моной Лизой/guillemotright.cyr. На протяжении 1990-2000 годов журналист предпринимал
несколько попыток узнать имя девочки. Несколько женщин ошибочно объ-
являли себя /guillemotleft.cyrАфганской девочкой/guillemotright.cyr; многие молодые люди называли ее сво-
ей женой. Через 17 лет после исходной фотографии фотограф нашел ее в
Афганистане и её личность была подтверждена при помощи биометрии, по-
казавшей полное соответствие радужной оболочки глаза изображению на
фотографии.
1.2.5 Индексирование и поиск изображений
Индексирование и поиск изображений ещё одна важная задача, для ре-
шения которой требуются алгоритмы анализа изображений. Коллекции и
9
архивы изображений бывают разные.
• Персональные. Например, в отпуске человек может сделать пару ты-
сяч фотографий, с которыми потом нужно что-то делать.
• Профессиональные. Они насчитывают миллионы фотографий. Здесь
тоже есть необходимость как-то их организовывать, искать, находить
то, что требуется.
• Коллекции репродукций. Это тоже миллионы изображений. Сейчас у
большого количества музеев есть виртуальные версии, для которых
оцифровываются репродукции. Пока утопичная задача /emdash.cyr поиск всех
репродукций одного и того же автора. Человек по стилю может пред-
положить, что видит, допустим, картины Сальвадора Дали. Было бы
здорово, если бы этому научилась и машина.
Как упорядочить все эти коллекции? Какие ещё задачи можно решать?
Можно построить систему навигацию по коллекциям, классифицируя их по
темам. Отдельно складывать мишек, отдельно слонов, отдельно апельсины
/emdash.cyr так, чтобы пользователю потом было удобно ориентироваться по этой
коллекции.
Ещё одна задача /emdash.cyr это поиск дубликатов. В двух тысячах фотографий
из отпуска неповторяющихся значительно меньше. Мы любим эксперимен-
тировать, снимать с разной выдержкой, фокусным расстоянием и т.д., что
в итоге нам даёт большое количество "нечётких"дубликатов, т.е. пример-
ных копий. Кроме того, поиск по дубликатам может помочь обнаружить
незаконное использование вашей фотографии, которую вы однажды могли
выложить в интернете.
Ещё одна интересная задача /emdash.cyr выбор лучшей фотографии. С помощью
алгоритма можно понять, какая картинка больше всего понравится поль-
зователю. Например, если это портрет, лицо должно быть освещено, глаза
открыты, изображение должно быть чётким и т.д. В современных фотоап-
паратах есть такая функция.
Ещё одна задача поиска /emdash.cyr создание коллажей, т.е. подбор фотографий,
которые будут хорошо смотреться рядом.
1.2.6 Ещё приложения
Есть ещё большое количество прикладных задач, где используется анализ
изображений.
• Системы слежения и целенаведения в военной промышленности. Оче-
виднымипримерамиявляютсяобнаружениевражескихсолдатитранс-
портных средств и управление ракетами. Наиболее совершенные си-
стемы управления ракетами посылают ракету в заданную область,
вместо конкретной цели, а выбор целей производится, когда ракета
достигает заданной области, основываясь на получаемых видеодан-
ных.
10
• Автономные транспортные средства, как для военного применения,
так и для автомобилестроения в целом. Уровень автономности из-
меняется от полностью автономных (беспилотных) до транспортных
средств, где системы, основанные на компьютерном зрении, поддер-
живают водителя или пилота в различных ситуациях. Полностью ав-
тономные транспортные средства используют компьютерное зрение
для навигации, то есть для получения информации о месте своего
нахождения, для создания карты окружающей обстановки, для обна-
ружения препятствий. Примерами таких систем могут быть система
предупредительной сигнализации о препятствиях на машинах, систе-
мыавтономнойпосадкисамолётов.Сегодняактивноразрабатываются
и тестируются системы автономного управления автомобилем.
• Компьютерное зрение также активно используется в киноиндустрии
при создании спецэффектов, для совмещения игры живых актёров
с компьютерной анимацией. Сегодня создатели фильмов могут запи-
сать эмоции настоящего актёра и наложить их на нарисованного пер-
сонажа или на лицо другого актёра. Компьютерное зрение сегодня
- неотъемлемая часть абсолютного большинства компьютерных игр,
приложений виртуальной и дополненной реальности.
• Зондирование земной поверхности с использованием видимого и ин-
фракрасного диапазонов спектра - ещё одна важная область примене-
нияалгоритмованализаизображений.Изображениянаселённыхпунк-
тов часто (и давно) используются для оценки роста численности на-
селения, динамики загрязнения окружающей среды. По изображени-
ям со спутников автоматически составляют карты местности. Наблю-
дение за погодой и составления прогнозов также является важным
применением спутниковых изображений. Обнаружение и предсказа-
ние ураганов, обнаружение лесных пожаров, и даже изменение уровня
поверхности земли как показатель истощения подземных вод - все это
делается сегодня при помощи анализа спутниковых снимков земли.
• Оцифровка печатных документов, обнаружение и распознавание тек-
ста - ещё один пример применения алгоритмов анализа изображений.
Сегодня существуют приложения, которые позволяют в режиме ре-
ального времени переводить указатели и таблички с иностранного
языка.
• И, конечно, компьютерное зрение - неотъемлемая компонента системы
навигации и управления роботов.
1.3 Задачи и наборы данных
1.3.1 Задачи
Мы рассмотрели большое число различных прикладных задач, в которых
используется компьютерное зрение. Как же можно научить компьютер "по-
11
нимать"изображения, чтобы можно было решать все эти задачи?
Давайте посмотрим на одно видео. Ваша задача - посчитать сколько раз
передают мяч друг другу игроки в белом.
Заметили ли вы, что среди игроков прошёл человек, наряженный в ко-
стюм медведя? Давайте посмотрим видео ещё раз.
После того, как я вам сказала про медведя, Вы его, конечно заметили.
Потому что Вы знали, что искать.
Это видео демонстрирует, что даже зрительная система человека обыч-
но в каждый конкретный момент времени решает какую-то одну постав-
ленную задачу, игнорируя сигналы, которые не относятся к решению этой
задачи. Точно также при разработке приложений компьютерного зрения
люди обычно решают какую-то одну конкретную поставленную задачу. Это
существенно проще, чем пытаться решить абстрактную задачу "научить
компьютер понимать изображение".
Какие же конкретные задачи чаще всего решаются в различных систе-
мах компьютерного зрения?
• Обнаружение лиц - найти на изображении все человеческие лица.
• Распознавание лиц - определить, какому человеку соответствует дан-
ное лицо.
• Идентификациялиц-определить,соответствуетлиданноелицокакому-
то конкретному человеку.
• Распознавание позы - определить какой позе из набора заранее задан-
ных поз соответствует данная поза человека.
• Выделение областей, однородных по цвету или текстуре.
• Распознаваниеобъектов-определитькакомуиззаранееопределённых
классов относится данный объект на изображении.
• Семантическая сегментация - выделение областей изображения, отно-
сящихся к одному объекту.
• Классификация изображений - определение к какой категории отно-
сится изображение или изображённые на нем объекты, без локали-
зации этих объектов на изображении. При помощи классификации
изображений можно ответить на такие вопросы об изображении как
изображён ли на картинке слон, или самолёт, или закат. Без указания
где именно на картинке расположен слон или самолёт.
• Обнаружение и распознавание текста - определить, где на картинке
изображён текст и распознать что там написано.
И даже такая общая задача, как семантическое описание изображения
может быть решена как совокупность перечисленных ранее более узких за-
дач.Например,давайтепосмотримнаэтуфотографию.Еслияваспопрошу
12
описать эту фотографию словами, скорее всего я услышу, что на фотогра-
фии изображена маленькая девочка, которая ест мороженное. Вы сможете
описать во что она одета, где она находится.
можно составить похожее описание изображения автоматически при по-
мощи компьютера, рашив такие задачи, как распознавание объектов и лиц,
определение пола и возраста человека, выделение однородных по цвету об-
ластей, распознавание действия, выделение текстуры.
1.3.2 Наборы данных
Очень важную роль в развитии области компьютерного зрения (как и во
многих других областях анализа данных) играют общедоступные наборы
данных, собранные для тестирования и сравнения различных алгоритмов,
решающихкакую-токонкретнуюзадачу.Стандартныенаборыданныхнеоб-
ходимы для объективного сравнения различных подходов к решению одной
и той же задачи. Данные необходимы для разработки алгоритмов, основан-
ных на машинном обучении.
Давайте познакомимся с наиболее известными наборами данных, ис-
пользующимися научным сообществом для разработки и тестирования все
более и более совершенных алгоритмов анализа изображений.
Lena Наверное, самым известным тестовым изображением, использовав-
шимся для проверки и демонстрации различных алгоритмов обработки
изображений, является /guillemotleft.cyrЛена/guillemotright.cyr. Тестовое изображение представляет собой
оцифрованный портрет шведской модели, который в свою очередь являет-
ся фрагментом разворота из журнала Playboy. Согласно Википедии, в 1973
году Александру Савчуку из Университета Южной Калифорнии для иллю-
страции статьи на тему обработки изображений понадобился фотопортрет с
хорошим динамическимдиапазоном. Савчукотсканировалфрагмент посте-
ра из Playboy. Он использовал сканер с разрешением 100 линий на дюйм,
и результирующее изображение получилось 512 на 512 точек. Вскоре эта
картинка превратилась для индустрии в стандарт де-факто: на нём прове-
рялись и отрабатывались всевозможные приёмы коррекции изображений,
оттачивались новые алгоритмы обработки.
MNIST Одним из первых наборов изображений для тестирования алго-
ритмов машинного обучения является коллекция MNIST (сокращение от
/guillemotleft.cyrModiﬁed National Institute of Standards and Technology/guillemotright.cyr). Она состоит из
содержит образцы рукописного написания цифр. С использованием этого
набора данных разрабатывались первые алгоритмы анализа изображений
на основе нейронных сетей. Коллекция MNIST содержит 60000 изображе-
ний для обучения и 10000 изображений для тестирования размером 28х28
пикселей. Все изображения поделены на 10 классов, по числу цифр. Задача
распознавания рукописных цифр на этом наборе данных - это классическая
задача классификации. Необходимо по изображению определить к какому
13
классу оно принадлежит (т.е. какая из 10 цифр изображена). По сегодняш-
ним меркам, и размер коллекции, и разрешение изображений очень неболь-
шой. Но этот набор данных по-прежнему активно используется, в основном
при обучении нейронным сетям. Запрограммировать нейронную сеть для
обучения и тестирования на этом наборе данных, это как написать "Hello
World"на новом языке программирования.
CIFAR CIFAR-10 и CIFAR-100 - тоже популярные наборы данных для
тестирования нейронных сетей. По количеству и разрешению изображений
они похожи на MNIST, но изображения более разнообразны. CIFAR-10 со-
держит картинки из 10 классов, таких как самолёт, машина, птица, и тому
подобные. CIFAR-100 содержит картинки из 100 классов. Эти наборы дан-
ных также широко используются для тестирования алгоритмов классифи-
кации изображений.
ImageNet ImageNet - размеченная коллекция изображений, с созданием
которой многие связывают начало эпохи глубокого обучения и успех глубо-
ких нейронных сетей. Для обучения глубоких сетей нужно много данных.
ImageNet - первый действительно большой набор аннотированных изобра-
жений. ImageNet содержит более 14 миллионов изображений (сравните с
60000 в MNIST и CIFAR!), разбитых на более чем 20000 классов.
С использованием этой коллекции данных с 2010 года проводится сорев-
нование ILSVRC (англ. ImageNet Large Scale Visual Recognition Challenge /emdash.cyr
Кампания по широкомасштабному распознаванию образов в ImageNet), в
рамках которого различные программные продукты ежегодно соревнуются
в классификации и распознавании объектов и сцен в базе данных ImageNet.
ДляILSVRCиспользуетсяподмножествоколлекцииImageNet,состоящееиз
около 1.2 миллиона изображений и 1000 классов.
PASCAL VOC До появления ImageNet и ILSVRC наиболее известным
соревнованием по классификации изображений и обнаружению объектов
было PASCAL VOC challenge (Pattern Analysis, Statistical Modelling and
Computational Learning Visual Object Classes), проводившееся с 2005 по 2012
год. Коллекций изображений, собранные для этого соревнования, долгое
время являлись де-факто стандартом для тестирования различных алго-
ритмов, особенно для алгоритмов обнаружения объектов и сегментации.
PASCAL VOC в отличие от предыдущих обсуждавшихся коллекций содер-
жит разметку на уровне объектов, когда на изображении размечены реги-
оны с объектами.
http://host.robots.ox.ac.uk/pascal/VOC/databases.html
http://host.robots.ox.ac.uk/pascal/VOC/images/tud3c.html
Caltech Caltech101 и Caltech256 ещё две коллекции изображений для те-
стирования алгоритмов классификации изображений и распознавания объ-
ектов. Коллекции содержат изображения 101 и 256 категорий соответствен-
14
но. Размер картинок примерно 200х300 пикселей - как в ImageNet и PASCAl
VOC. Большинство категорий Caltech101 содержит около 50 изображений,
но есть категории с намного большим числом картинок. Например в кате-
гориях "самолет"и "лицо"около 800 примеров.
К каждому изображению прилагается аннотация, содержащая коорди-
наты рамки в которой находится объект и класс объекта.
http://www.vision.caltech.edu/Image_Datasets/Caltech101/
http://www.vision.caltech.edu/Image_Datasets/Caltech256/
MS COCO Все рассмотренные нами ранее коллекции содержат изобра-
жения относительно небольшого размера. В то же время, большинство ка-
мер сегодня снимает с более высоким разрешением. И для ряда задач (на-
пример, распознавание объектов для автономных транспортных средств)
важно уметь работать с изображениями с более высоким разрешением. MS
COCO (Microsoft COCO: Common Objects in Context) содержит изображе-
ния с разрешением до 1000 пикселей вдоль большей стороны. Также боль-
шинство коллекций, о которых мы говорили до этого, не имеет разметки
для семантической сегментации, когда для каждого пикселя изображения
ест метка о его принадлежности к определённому объекту.
Коллекция MS COCO сегодня является стандартом для сравнения ал-
горитмов распознавания объектов и семантической сегментации. Она со-
держит 328000 изображений с объектами 91 категории. Всего в коллекции
около 2500000 размеченных объектов.
http://cocodataset.org/#home
https://arxiv.org/pdf/1405.0312.pdf
Cityscapes Ещё один широко используемый набор изображений высокого
разрешения - Cityscapes. Коллекция содержит изображения городских пей-
зажей, собранных в 50 городах Европы. Размер изображений 1024 x 2048
пикселей. В наборе данных 5000 изображений с детальной аннотацией объ-
ектов - на уровне отдельных пикселей, и около 20000 изображений с менее
детальной аннотацией.
https://www.cityscapes-dataset.com/
https://arxiv.org/pdf/1604.01685.pdf
Labeled Faces in the Wild Помимо коллекций, содержащих картин-
ки всевозможных категорий объектов, существуют также наборы данных
для распознавания определённых категорий, имеющих особую значимость.
Так, существуют размеченные наборы для обнаружения пешеходов (http:
//coding-guru.com/popular-pedestrian-detection-datasets/ ),распозна-
вания жестов, распознавания дорожных знаков.
Отдельного внимания всегда заслуживала задача обнаружения и распо-
знавания лиц. Было создано большое количество размеченных коллекций
для этих задач. Одной из наиболее широко используемых сегодня коллек-
ций является Labeled Faces in the Wild:
15
http://vis-www.cs.umass.edu/lfw/.
Как следует из названия, коллекция содержит изображения лиц в "есте-
ственных условиях без контроля над освещением, позой человека и его голо-
вы. Это не портретная съёмка на монотонном фоне, а репортажные кадры.
Коллекция содержит более 13000 изображений известных людей, собран-
ных в интернете. Около 1680 личностей из коллекции имеют более одной
фотографии.
Медицинские изображенияНесмотря на то, что анализ медицинских
изображений является одной из основных прикладных задач компьютер-
ного зрения, общедоступных коллекций медицинских изображений не так
много. В первую очередь это связано с персональным аспектом этих дан-
ных. Только в последние годы, когда стало ясно что доступность боль-
ших коллекций данных способна значительно ускорить развитие алгорит-
мов, начали появляться объёмные анонимизированные коллекции меди-
цинских снимков. Первой такой коллекцией, получившей распространение
среди групп машинного обучения, была ChestXray14, содержащая около
112,000 снимков грудной клетки с признаками 14 видов болезней. Недавно
группа машинного обучения Стэнфорда выпустила ещё одну объёмную кол-
лекциюCheXpert.Этаколлекциясодержит224316снимковгруднойклетки.
http://academictorrents.com/details/557481faacd824c83fbf57dcf7b6da9383b3235a
https://stanfordmlgroup.github.io/competitions/chexpert/
https://arxiv.org/abs/1901.07031
1.4 Основы зрительного восприятия человека
Системы компьютерного зрения, во многом, строятся по аналогии со зри-
тельной системой человека. Если мы хотим научить машину видеть мир
и анализировать визуальную информацию так, как это делает человек, то
сначала надо разобраться, как же работает зрительная система человека.
Как изображение формируется в глазу? Какого рода информацию человек
способен извлечь из визуального сигнала? Какими физическими ограни-
чениями обладает система зрительного восприятия человека? Всё это не
только интересно, но и важно в практическом плане.
Зрительная система человека обладает удивительными способностями.
Мы распознаём людей и предметы в самых различных условиях: с различ-
ных ракурсов, при разном освещении, даже если видна только часть объек-
та. Мы способны с лёгкостью извлечь информацию о размерах предметов,
местоположении относительно друг друга, расстояниях между объектами.
Наш мозг способен "достроить"картинку, если видна только ее часть.
В то же время, наша зрительная система далеко не идеальна. Мы под-
властны иллюзиям, не замечаем многие детали, наше восприятие неодно-
значно и субъективно, зависит от нашего "зрительного опыта".
Давайте посмотрим на несколько примеров, иллюстрирующих способ-
ности зрительной системы человека.
16
Как видим мы- внутриклассовая изменчивость объектовПосмот-
рите на картинки на этом слайде. Для нас не составляет никакого труда
понять, что всё это - изображения разных видов ламп, даже если некото-
рые из этих ламп вы видим впервые в жизни. Лампы могут быть разной
формы, разного цвета, разного размера. Но мы всё равно понимаем, что это
всё - лампы.
Как видим мы - неоднозначность восприятияА что вы видите
на этих изображениях? На самой левой картинке можно увидеть молодую
женщину или старуху в платке, на центральном - эскимоса или индейца, на
правом - саксофониста или лицо женщины. Наше восприятие неоднозначно.
Несколько фактов о нашем зрительном восприятии - 1Мозг и наш
зрительный опыт играет очень важную роль в том, как мы интерпретируем
зрительный сигнал. Мозг способен "достроить"картинку, даже если видна
только часть, или добавить семантику, распознать объект, даже когда его
там нет. Человек часто даёт не соответствующее действительности объясне-
ние наблюдаемой им картине. Мы все можем узнать "что-то"или "кого-то"в
очертании облака.
То, как наш мозг достраивает и интерпретирует картинку очень сильно
зависит от нашего зрительного опыта. Наша зрительная система "самообу-
чается"на протяжении всей нашей жизни. Нам проще распознавать изобра-
жения, привычные нашему глазу. Например, типичному европейцу сложно
различать лица азиатов, а людям выросшим среди африканцев, все белые
будут казаться "на одно лицо".
Посмотрите на эту черно-белую картинку. Можете распознать, что это?
А если перевернуть? В привычной ориентации существенно проще распо-
знать очертания карты мира.
Несколько фактов о нашем зрительном восприятии - 2Ещё пара
иллюстраций к тезису о том, что мы часто ищем в изображении знако-
мые образы, и наш мозг "достраивает"картинку. Это примеры известных
оптических иллюзий, в которых глаз восполняет несуществующую инфор-
мацию.
На левом рисунке ясно видны очертания квадрата, вопреки тому фак-
ту, что на изображении отсутствуют линии, определяющие такую фигуру.
Аналогичный эффект, на этот раз в виде круга, виден на левом рисунке.
Всего нескольких линий достаточно для получения иллюзии круга.
Несколько фактов о нашем зрительном восприятии - 3От того,
где мы выросли, зависит, как мы "видим"мир вокруг нас. Например, на
этом рисунке ступеньки идут вверх или вниз? Большинство из нас, кто
пишет и читает слева направо, ответят, что вверх. А для тех, кто привык
читать справа налево, ступеньки будут вести вниз.
17
Строение человеческого глазаГлаз имеет почти сферическую форму
со средним диаметром около 20 мм. По сути, глаз - это оптическая сфера.
Светпроникаетвглазчереззрачок-отверстиевцентрерадужнойоболочки
глаза, преломляется хрусталиком и проецируется на внутреннюю оболочку
глаза - сетчатку.
Зрачок может сужаться или расширяться, регулируя тем самым коли-
чество попадающего света. Диаметр зрачка может изменяться в пределах
от 2 до 8 мм.
Хрусталик, расположенный за радужной оболочкой глаза и зрачком,
играет роль оптической линзы. В отличие от жёсткой оптической линзы,
оптическая сила хрусталика может изменяться за счёт изменения его фор-
мы. Как видно ра рисунке, радиус кривизны передней поверхности капсулы
хрусталика больше, чем задней. Изменение формы хрусталика происходит
путём ослабления или натяжения передней и задней порции волокон рес-
ничногопояска.Дляфокусировкизрениянаудалённомпредметересничная
мышца расслабляется, хороидея сжимается, натягивая при этом волокна
ресничного пояска, в результате чего хрусталик приобретает уплощенную
форму. А для фокусировки на близкорасположенном предмете ресничная
мышца сокращается, что приводит к округлению хрусталика и увеличению
его преломляющей способности. При изменении преломляющей способно-
сти хрусталика с минимального значения до максимального, его фокусное
расстояние изменяется от 17 мм до 14 мм. При рассмотрении предметов на
расстоянии больше 3 метров преломляющая способность хрусталика мини-
мальна, при разглядывании предметов вблизи, преломляющая способность
хрусталика максимальна.
При правильной оптической фокусировке глаза свет от наружного объ-
екта проецируется в виде изображения на сетчатку. По внутренней по-
верхности сетчатки распределены дискретные светочувствительные клетки
(рецепторы), которые регистрируют изображение. Эти рецепторы бывают
двухвидов-колбочкиипалочки.Колбочкиобладаютвысокойчувствитель-
ностью к спектральным составляющим света и обеспечивают фотопическое
зрение - зрение в ярком свете. В глазу насчитывается от 6 до 7 миллионов
колбочек. Все они располагаются преимущественно в в центральной обла-
сти сетчатки, называемой жёлтым пятном. В центре жёлтого пятна имеется
так называемся центральная ямка - область наибольшей остроты зрения.
Человек различает мелкие детали изображения в основном благодаря кол-
бочкам.Каждаяколбочкасоединенасотдельнымнервнымокончанием.На-
ружные мышцы глаза обеспечивают вращение глазного яблока так, чтобы
изображение интересующего объекта попало в область жёлтого пятна.
Палочек в глазу намного больше, чем колбочек - от 75 до 50 милли-
онов. В отличие от колбочек, палочки распределены по всей поверхности
сетчатки, и к одному нервному окончанию присоединено сразу несколько
палочек (в среднем, около 10). Это уменьшает их способности различать
детали изображения. Палочки позволяют сформировать общую картину
всего поля зрения. Они наиболее чувствительны при низких уровнях осве-
щённости и не участвуют в обеспечении функции цветного зрения. Поэтому
18
предметы, имеющие яркую окраску при ярком освещении, выглядят как
лишённые цветов образы при сумеречном освещении, так как при сумереч-
ном освещении возбуждаются только палочки. Это явление известно как
скотопическое (или сумеречное) зрение.
Яркостная адаптация и контрастная чувствительность - 1Знание
о способности глаза различать разные уровни яркости имеет важное прак-
тическое значение. Оно поможет выбрать правильную схему дискретизации
уровня яркости для представления цифровых изображений.
Зрительнаясистемачеловекаспособнаадаптироватьсякогромномудиа-
пазону значений яркости, порядка1010 - от порога чувствительности ско-
топического зрения до предела ослепляющего блеска. Эксперименты так-
же показывают, что субъективная яркость (т.е. яркость, как она воспри-
нимается человеком) является логарифмической функцией от физической
яркости света, попадающего в глаз. На слайде изображен график этой за-
висимости субъективной яркости от истинной яркости. Длинная сплошная
кривая представляет диапазон яркостей, в котором способна адаптировать-
ся зрительная система человека. При использовании одного фотопического
зрения этот диапазон составляет около106. При низких уровнях яркости
происходит постепенный переход от от фотопического к скотопическому
зрению.
Яркостная адаптация и контрастная чувствительность- 2Но важ-
нопонимать,чтоэтодинамическийдиапазон-зрительнаясистемачеловека
не способна работать во всем этом диапазоне одновременно. Она охватыва-
ет такой большой диапазон за счёт изменения общей чувствительности. Это
явление известно как яркостная адаптация. Общий диапазон одновремен-
но различаемых уровней яркости относительно мал по сравнению со всем
диапазоном адаптации. Для любого данного набора внешних условий теку-
щий уровень чувствительности зрительной системы, называемый уровнем
яркостной адаптации, соответствует некоторой яркости, например, точке
Ba на графике. Короткая кривая, пересекающая основной график, пред-
ставляет диапазон субъективной яркости, которую способен воспринимать
глаз при адаптации к указанному уровню. Этот диапазон достаточно огра-
ничен: все уровни яркости нижеBb субъективно воспринимаются зрением
как чёрное и неразличимы. Верхняя пунктирная часть этой кривой реально
не ограничена, но теряет смысл при большой длине, поскольку при повы-
шении яркости просто повышается уровень адаптацииBa.
Способность зрения различать изменения яркости при данном уровне
адаптации также представляет значительный интерес. Классический экс-
перимент для определения способности зрительной системы человека раз-
личать разные уровни яркости состоит в следующем. Испытуемого про-
сят смотреть на большой плоский равномерно освещённый экран. Экран
должен быть такого размера, чтобы занимать все поле зрения испытуемо-
го. Яркость экрана (обозначенная I на слайде) можно регулировать. На
19
это равномерно освещённый экран накладывается добавочная яркостьδI в
форме кратковременной вспышки в области круглой формы, расположен-
ной в центре экрана, как изображено на слайде.
Малые приращенияδI неразличимы для испытуемого - он не замечает
вспышек. По мере увеличенияδI в какой-то момент испытуемый начнёт
замечать вспышки, т.е. будет воспринимать изменение яркости. Величина
δIc/I, гдеδIc - величина приращения яркости, различимая в 50% случаев на
фонеяркостиI,называетсяотношениемВебера.Малоезначениеотношения
Вебера означает, что различаются очень малые относительные изменения
яркости, т.е. имеет место высокая контрастная чувствительность. Большое
значение отношения Вебера означает, что требуется большое относительное
изменение яркости, чтобы его можно было заметить. Это говорит о низкой
контрастной чувствительности.
График зависимости логарифма отношения Вебера от логарифма фоно-
вой яркости (log(δIc/I) отlog(I)) изображён на слайде. Эта кривая пока-
зывает, что низкая контрастная чувствительность (т.е. большое отношение
Вебера) наблюдается при малых уровнях яркости. Контрастная чувстви-
тельность заметно возрастает при увеличении фоновой яркости. Наличие
двух частей кривой отражает тот факт, что при малых уровнях яркости
зрение осуществляется благодаря палочкам, а при больших уровнях ярко-
сти - за счёт колбочек.
Если поддерживать фоновую яркость постоянной, а яркость добавочно-
го источника варьировать не вспышками, а ступенчатым изменением ярко-
сти от неотличимого до заметного всегда, то типичный наблюдатель спосо-
бен различить всего 10-20 ступеней яркости. Грубо говоря, это означает, что
в произвольной точке монохромного изображения, человек способен разли-
чить всего 10-20 уровней яркости. Но это не означает, что всё изображение
может быть представлено таким небольшим числом градаций яркости. По
мере движения глаза по изображению меняется среднее значение яркости
фона, что позволяет нам обнаруживать различные множества относитель-
ных изменений яркости для каждого нового уровня адаптации. Следствием
этого является способность глаза различать яркости в намного более ши-
роком общем диапазоне, чем 20 уровней.
Воспринимаемая яркость, как функция истинной яркости: полосы
Маха Воспринимаемая яркость не является простой функцией истинной
яркости. Известны два явления, подтверждающие это утверждение. Пер-
вое основывается на том факте, что вблизи границ соседних областей с
отличающимися, но постоянными яркостями зрение человека склонно "под-
чёркивать"яркостные перепады. Посмотрите на картинку на слайде. Нам
кажется, что яркость полос не постоянна, что вблизи границы с более свет-
лой полосой яркость становится ниже, а вблизи границы с более тёмной
полосой яркость становится выше. Хотя на самом деле яркость каждой из
полос постоянна. Эти полосы с кажущимися изменениями яркости на краях
называются полосами Маха в честь Эрнста Маха, впервые описавшего этот
20
феномен в 1865г.
Воспринимаемая яркость, как функция истинной яркости: одно-
временный контрастВтрое явление, называемое одновременным кон-
трастом, связано с тем фактом, что воспринимаемая яркость некоторой об-
ласти определяется не только ее собственной истинной яркостью, но и ярко-
стью соседних областей. В верхней части слайда все три внутренних квад-
рата имеют одинаковую яркость. Но зрительно левый внутренний квадрат
воспринимается светлее, чем правый - потому что фон левого квадрата тем-
нее, чем фон правого. Чем более светлый фон, тем темнее кажется объект
на этом фоне.
Тот же эффект наблюдается и на картинке в нижней части слайда. Обе
тонкие полосы имеют одинаковую яркость, но нам кажется, что левая по-
лоса светлее правой.
Ещё одним примером является лист белой бумаги, который кажется бе-
лым, когда он лежит на столе, но может показаться совершенно чёрным,
если им закрывать глаза, глядя на яркое небо.
Иллюзия с тенью на шахматной доскеИ ещё одна иллюзия, в ос-
нове которой также лежит феномен одновременного контраста. Зрительно
квадрат А нам кажется темнее квадрата B.
Иллюзия с тенью на шахматной доске-2Хотя на самом деле, оба
квадрата, A и B, абсолютно одинаковой яркости.
1.5 Цвет
Мы поговорили немного о яркости и её восприятии человеком. Давайте
теперь обратимся к цвету. Что есть цвет? Как наша зрительная система
распознает разные цвета?
Как и в случае с яркостью, воспринимаемый нами цвет зависит не толь-
ко от физических свойств освещения и объектов. Строго говоря, восприни-
маемый нами цвет - это результат взаимодействия между световыми вол-
нами и нашей зрительной системы.
Спектр Хотя процесс восприятия и интерпретации цвета человеческим
мозгом представляет собой не до конца исследованное психофизиологиче-
ское явление, физическая природа цвета может быть точно описана.
Ещё в 1666г. сэр Исаак Ньютон обнаружил, что при прохождении луча
солнечного света через стеклянную призму выходящий поток лучей не яв-
ляется белым, а состоит из непрерывного спектра цветов, от фиолетового
цвета на одном конце до красного на другом. Диапазон цветов, которые
мы воспринимаем как видимый свет, составляет очень малую часть спек-
тра электромагнитного излучения. На одном конце этого спектра находятся
21
радиоволны, длина которых в миллиарды раз превышает длины волн ви-
димого света, а на другом конце - гамма-лучи, длина которых в миллионы
раз меньше длины световых волн.
Электромагнитные волны можно трактовать как распространяющиеся
синусоидальные колебания с длиной волныλ, а можно - как поток частиц
с нулевой массой, движущихся со скоростью света. Каждая такая частица
не имеет массы, но обладает определённой энергией и называется кван-
том излучения, или фотоном. Энергия фотона пропорциональна частоте
излучения, т.е. электромагнитные колебания более высокой частоты (т.е. с
более короткой длиной волны) обладают большей энергией фотона. Таким
образом, у радиоволн энергия фотона мала, у микроволн энергия больше,
у инфракрасного излучения еще больше, далее энергия фотона последо-
вательно возрастает для диапазонов видимого спектра, ультрафиолетового
излучения, рентгеновских лучей, и, наконец, гамма-лучей, обладающих са-
мой большой энергией.
Светявляетсяособымвидомэлектромагнитногоизлучения,котороевос-
принимается человеческим глазом. На слайде приведён видимый цветовой
спектр в "растянутом"виде. Видимый диапазон электромагнитного спек-
тра охватывает длину волны приблизительно от 400 до 700 нм. Для удоб-
ства цветовой спектр часто делят на шесть широких цветовых диапазонов:
фиолетовый, синий, зелёный, жёлтый, оранжевый и красный. Это деле-
ние достаточно условно - иногда говорят о пяти цветах, объединяя красно-
оранжевый или сине-фиолетовый участки спектра, а иногда о семи цветах,
выделяя голубой участок спектра между синим и зелёным. Ни один цве-
товой диапазон не имеет ярко выраженных границ, вместо этого каждый
цвет плавно переходит в другой.
Итак, каждый источник света может быть однозначно определён его
спектром - количеством излучаемой энергии для каждой длины волны.
Отражаемый светЦвет, воспринимаемый человеком, как цвет объекта,
определяется характером света, отражённого от этого объекта. Предмет,
который отражает свет приблизительно одинаково во всём видимом диапа-
зоне, представляется наблюдателю белым. Предмет, который отражает свет
только в каком-то ограниченном диапазоне волн, будет восприниматься то-
го цвета, который соответствует отражаемому диапазону волн. Например,
красный предмет в основном отражает свет с длинами волн 625-740нм, по-
глощая большинство энергии в других интервалах длин волн.
Свет, лишенный цветовой окраски, называется ахроматическим или мо-
нохроматическим. Единственным параметром такого освещения является
его интенсивность, или яркость. Для описания монохроматической яркости
также используется термин уровень серого поскольку яркость изменяется
от черного до белого, с промежуточными оттенками серого.
Восприятие цвета: колбочкиРецепторами глаза, отвечающими за вос-
приятие цветов человеком, являются колбочки. Экспериментально было
22
установлено, что все 6-7 миллионов колбочек в нашем глазу могут быть
разделены на три основных группы по их восприимчивости к спектрально-
му составу света. Эти три группы приблизительно соответствуют чувстви-
тельности к коротким, средним и длинным волнам, или синему, зелёному
и красному цветам. Примерно 65% всех колбочек воспринимают красный
цвет, 33% - зелёный и только около 2% - синий. На слайде показаны экс-
периментальные кривые спектральной чувствительности колбочек каждой
из трёх групп для среднего нормального глаза.
Первичные и вторичные цветаВследствие таких спектральных ха-
рактеристик человеческий глаз воспринимает цвета как различные сочета-
ния так называемых первичных цветов: красного, зелёного и синего. В 1931
г. Международная комиссия по освещению (МКО) разработала стандарт-
ный набор монохроматических первичных основных цветов, зафиксировав
длины волн для стандартных синего, зелёного и красного цветов. Но важно
понимать,чтоналичиестандартногонаборамонохроматическихпервичных
основных цветов не означает, что все цвета спектра могут быть получены
на основе этих фиксированных RGB цветов. Использование термина /guillemotleft.cyrос-
новные/guillemotright.cyr часто приводит к тому заблуждению, что все видимые цвета могут
быть воспроизведены при смешении основных первичных цветов в различ-
ных пропорциях. Это не верно, за исключением того случая, когда длина
волны основных цветов также может изменяться. Но в этом случае уже
нельзя говорить о трёх стандартных первичных основных цветах.
Первичные основные цвета могут складываться, что даёт вторичные ос-
новные цвета: пурпурный (красный плюс синий), голубой (зелёный плюс
синий) и жёлтый (красный плюс зелёный). Смешение трёх первичных ос-
новных цветов, или вторичного основного цвета и противоположного ему
первичного, в правильных пропорциях даёт белый цвет. Результат такого
смешения показан на слайде, где также показаны три первичных основных
цвета и их сочетания, дающие вторичные основные цвета.
Также важно различать первичные основные цвета световых источни-
ков и первичные основные цвета красителей. Для красителей первичный
основной цвет определяется как цвет, который поглощает один первичный
основной цвет светового источника и отражает два оставшихся. Поэтому
для красителей первичными основными цветами являются пурпурный, го-
лубой и жёлтый, а вторичными /emdash.cyr красный, зелёный и синий. Правильная
комбинация трёх первичных основных цветов красителей или вторичного
основного цвета и противоположного ему первичного даёт чёрный цвет.
Основные цвета световых источников ещё называют аддитивными, а
красителей - субтрактивными.
1.6 Цифровое представление изображений
Как видит изображение компьютерДля формировании цифрового
изображения необходимо преобразовать непрерывный аналоговый сигнал,
23
поступающий с сенсоров, в цифровую форму путём дискретизации и кван-
тования. Давайте сначала рассмотрим монохромное изображение. Исход-
ное аналоговое изображение непрерывно по координатамxи y, а также по
уровню яркости. Чтобы преобразовать эту функцию в цифровую форму,
необходимо ее представить отсчётами по обеим координатам и по уровням
яркости. Представление координат в виде конечного множества отсчётов
называется дискретизацией, а представление уровня яркости в значениями
из конечного множества - квантованием.
В результате операций дискретизации и квантования возникает матрица
действительных чисел. Такой формат представления изображения в виде
матрицы называется растровым. Каждый элемент матрицы соответствует
одному пикселю изображения. Значение элемента соответствует уровню яр-
кости, или интенсивности, соответствующего пикселя. Значения интенсив-
ности часто отнормированы в диапазоне от 0 до 1. При такой нормировке
белый пиксель будет иметь значение 1, чёрный - значение 0.
Параметры растрового изображения-1Дваосновныхпараметрараст-
рового изображения - это его пространственное и яркостное разрешение.
Дискретизацияявляетсяглавнымфактором,определяющимпространствен-
ное разрешение изображения. По существу, пространственное разрешение
/emdash.cyr это размер мельчайших различимых деталей на изображении. Простран-
ственное разрешение (resolution) измеряется в числе пикселей на единицу
пространственного измерения. Стандартная единица измерения - ppi, pixels
per inch.
Размерность изображения тесно связана с его разрешением. Чем выше
разрешение изображения, тем бОльшего размера можно напечатать или
отобразить на экране изображение без видимой потери качества.
Если нет необходимости измерять реальное пространственное разреше-
ние и достигаемую степень детализации исходной сцены, то изображение,
имеющее размеры MxN пикселей, часто называют изображением с про-
странственным разрешением MxN пикселей.
Уровни яркостиЯркостным (или полутоновым) разрешением, называ-
ется мельчайшее различимое изменение яркости. Часто яркостное разреше-
ние задают в числе уровней (или градаций). В виду особенностей цифровой
техники, число уровней обычно выбирается равным степени 2. Наиболее ча-
стым решением является выбор 8-битного представления, что соответствует
256 уровням яркости. В некоторых приложениях используется 16 бит, если
необходимо иметь более точное представление полутонов. Иногда можно
встретить системы, в которых квантование уровней яркости изображения
проводится с 10 или 12 битами точности, но это скорее исключение, чем
правило.
На слайде приведены примеры изображений с разными уровнями ярко-
сти.
24
Параметры растрового изображения-2
Светлота, цветовой тон и насыщенностьЧасто для различения цве-
тов используются такие параметры, как светлота, цветовой тон и насы-
щенность. Светлота является субъективной характеристикой. Она отража-
ет уровень зрительного ощущения интенсивности света.
Цветовой тон характеризует доминирующий цвет, воспринимаемый на-
блюдателем. Когда мы называем некоторый объект красным, оранжевым
или жёлтым, мы обозначаем его цветовой тон.
Насыщенность цвета связана с его относительной белизной. Спектраль-
но чистые (монохроматические) цвета являются полностью насыщенными.
Такие цвета как розовый (смесь красного и белого) или бледно-лиловый
(смесь фиолетового и белого) менее насыщены. Причём величина насыщен-
ности цвета обратно пропорциональна количеству белого цвета в смеси.
Цветовой тон и насыщенность вместе называют цветностью. Каждый
цвет может быть охарактеризован своей цветностью и светлотой.
Координаты цветностиВеличины красного, зелёного и синего, необхо-
димые для получения некоторого конкретного цвета, называются коорди-
натами цвета и обозначаются соответственноX, Y иZ. Часто при описании
цвета светлота не представляет интереса, и в таком случае цветовой тон и
насыщенность можно выразить в координатах цветностиx, y и z, которые
определяются как
x= X
X+ Y + Z,y = Y
X+ Y + Z,z = Z
X+ Y + Z (1)
Из данных выражений видно, чтоx+ y+ z= 1.
Диаграмма цветностейДругой способ задавать цвета основан на ис-
пользовании диаграммы цветностей, созданной Международной Комисси-
ей по Освещению (МКО) в 1931г на основе серии экспериментов по оценке
восприятия цвета человеком. Вся совокупность цветов может быть пред-
ставлена как функцияx(красной) иy (зелёной) координат цветности. Для
любых значений координатx и y соответствующее значение синей коорди-
наты цветностиz может быть получено из выраженияz= 1− (x+ y).
Вдоль границы диаграммы цветностей, имеющей форму языка, распо-
ложены различные цвета спектра /emdash.cyr от фиолетового с длиной волны 380
нм до красного с длиной волны 780 нм. Любая точка, расположенная не на
границе, а внутри диаграммы, представляет некоторую смесь цветов. Точка
равной энергии, соответствующая координатам(x,y) = (1/3,1/3) соответ-
ствует равным долям трёх первичных основных цветов; она представляет
опорный белый цвет стандарта МКО. Любая точка, расположенная на гра-
нице диаграммы цветностей, имеет максимальную цветовую насыщенность.
По мере того как точка смещается от границы к точке равной энергии, со-
ответствующий ей цвет содержит в своём составе все большую долю белого
25
и становится все менее насыщенным. Цветовая насыщенность точки равной
энергии равна нулю.
Диаграмма цветности полезна при рассмотрении процедуры смешения
цветов,посколькуотрезок,соединяющийлюбыедветочкидиаграммы,опре-
деляет всевозможные различные цвета, которые могут быть получены при
смешении двух данных цветов. Аналогично, отрезок, проведённый от точки
равной энергии к любой точке границы диаграммы, определяет все оттенки
выбранного цвета.
Цветовой охватТакаяпроцедураобобщаетсяинаслучайсмешениятрёх
цветов. Для того чтобы определить диапазон цветов, которые могут быть
получены комбинацией трёх любых заданных цветов, нужно просто соеди-
нить между собой отрезками соответствующие точки на диаграмме цвет-
ности. В результате получится треугольник, и все цвета, соответствующие
точкам внутри этого треугольника, могут быть получены как различные
комбинации трёх первоначальных цветов.
Заметим, что никакой треугольник с вершинами в трёх точках с неиз-
менными цветами не может включать весь диапазон цветов диаграммы
цветностей. Это означает, что нельзя получить все цвета с помощью трёх
фиксированных первичных основных цветов.
Треугольник, отмеченный правом рисунке, представляет типичный для
RGB мониторов диапазон воспроизводимых цветов, который называют цве-
товым охватом. Область сложной формы внутри этого треугольника пред-
ставляет типичный цветовой охват печатающих устройств. Граница обла-
сти охвата для печатающих устройств имеет сложную форму, потому что
в процессе цветной печати одновременно используются аддитивные и суб-
трактивные процедуры смешения цветов. Управлять таким процессом на-
много труднее, чем процессом воспроизведения цветов на экране монитора,
основанном на смешении трёх хорошо контролируемых первичных основ-
ных цветов.
1.7 Модели цвета
Для того, чтобы сделать возможным описание цветов некоторым стандарт-
ным способом, введём понятие цветового пространства. Цветовое простран-
ство также иногда называют цветовой моделью или системой цветов. По
существу, цветовое пространство определяет некоторую систему координат
и подпространство внутри этой системы, в котором каждый цвет представ-
ляется единственной точкой.
Большинство современных цветовых пространств ориентированы ли-
бо на устройства цветовоспроизведения (например, цветные мониторы или
принтеры), либо на определённые прикладные задачи обработки изображе-
ний. Аппаратно-ориентированными цветовыми моделями, наиболее часто
используемыминапрактике,являютсямодельRGBдляцветныхмониторов
и широкого класса цветных видеокамер, модели CMY и CMYK для цветных
принтеров, и модели, разделяющие цветовую и яркостную информацию
26
на изображении, такие как Hue-Saturation-Intensity (HSI), Hue-Saturation-
Value(HSV),Hue-Saturation-Lightness(HSL),Hue-Saturation-Brightness(HSB).
Такие модели лучше соответствуют цветовосприятию человека и дают воз-
можность применять многие из полутоновых методов обработки изображе-
ний и для цветных изображений.
Ещё одно популярное цветовое пространство, используемое в задачах об-
работки изображений - CIE LAB, в котором изменение цвета более линейно
с точки зрения человеческого восприятия.
Далее рассмотрим более подробно некоторые из этих пространств.
RGB Наверное, самым распространенным цветовым пространством яв-
ляется пространство RGB. В данной модели каждый цвет представляется
красным, зеленым и синим первичными основными цветами. В основе мо-
дели лежит декартова система координат. Цветовое пространство представ-
ляет собой куб. Точки, отвечающие красному, зелёному и синему цветам,
расположены в трех вершинах куба, лежащих на координатных осях. Го-
лубой, пурпурный и желтый цвета расположены в трёх других вершинах
куба. Чёрный цвет находится в начале координат, а белый /emdash.cyr в наиболее
удалённой от начала координат вершине. В рассматриваемой модели от-
тенки серого цвета (точки с равными RGB значениями) лежат на диагона-
ли, соединяющей чёрную и белую вершины. Различные цвета в этой модели
представляют собой точки на поверхности или внутри куба и определяются
вектором, проведённым в данную точку из начала координат. Для удобства
предполагается, что все значения цвета нормированы таким образом, что-
бы куб был единичным кубом, т.е. все значенияR,G и лежат в диапазоне
[0,1].
Представляемые в цветовой модели RGB изображения состоят из трёх
отдельных изображений-компонент, по одному для каждого первичного ос-
новного цвета. При воспроизведении RGB монитором эти три изображения
смешиваются на люминесцируюшем экране и образуют составное цветное
изображение. Число битов, используемых для представления каждого пик-
селя в RGB пространстве, называется глубиной цвета. Рассмотрим RGB
изображение, в котором каждая из компонент /emdash.cyr красная, зеленая и си-
няя /emdash.cyr является 8-битовой. В таком случае говорят, что каждый цветной
RGB пиксель (т.е. триплет значений (R, G, В)) имеет глубину 24 бита (три
цветовые плоскости умножить на число битов на каждую плоскость); для
такого изображения часто используется термин полноцветное изображение.
Суммарное число всевозможных цветов в 24-битовом RGB изображении со-
ставляет(28)3 = 16777216.
Цветовая система МанселлаЦветовая (или колориметрическая) си-
стема Манселла /emdash.cyr цветовое пространство, разработанное профессором Аль-
бертом Манселлом в начале XX века. Цвет в нем описывается с помощью
трёх чисел /emdash.cyr цветового тона, значения (светлоты) и хромы (насыщенно-
сти). Попытки создать цветовое пространство, цвет в котором описывался
27
бы тремя координатами, были и до Манселла, но он первым решил раз-
делить цвет на независимые значения тона, светлоты и насыщенности. Его
система, особенно её поздние редакции, основывалась на тщательных экспе-
риментах по изучению цветового восприятия человека, то есть под неё была
подведенанаучнаяоснова.Благодаря этому,цветоваясистема Манселлапе-
режила многие системы того времени, и, хотя в большинстве приложений
её заменили более современные системы, такие как (CIE L*a*b), она все
ещё применяется в некоторых областях. Например, в стандартах ANSI для
определения цвета кожи и волос человека, в судебной медицине, в геологии
для сравнения цвета почвы и в пивоварении для определения цвета пива.
Цветовая система Манселла включает три координаты. Цветовое тело
можно представить как цилиндр в трёхмерном пространстве. Цветовой тон
измеряется в градусах по горизонтальной окружности, хрома (насыщен-
ность) измеряется радиально от нейтральной оси цилиндра к более насы-
щенным краям, значение (светлота) измеряется вертикально по оси цилин-
дра от 0 (черный) до 10 (белый). Расположения цветов определялось экс-
периментально изучением цветового ощущения испытуемых. Цвета Ман-
селл пытался расположить визуально одинаково, что привело к образова-
нию цветового тела неправильной формы.
Каждый горизонтальный круг в системе Манселла разделен на пять ос-
новных тонов: красный (Red), желтый (Yellow), зеленый (Green), голубой
(Blue)ифиолетовый(Purple).Междунимирасполагаютсяпятьпереходных
тонов. В нижней части слайда показаны цветовые тона по Манселлу для
фиксированных значений насыщенности и светлоты. Два цвета одинаковой
светлоты и насыщенности на противоположных сторонах круга смешива-
ются в нейтральный серый того же значения.
HSI Другимицветовымипространствами,используемымивобработкеизоб-
ражений и схожими с системой Манселла, является семейство пространств
HSI/HSL/HSV/HSB. Цветовое пространство RGB идеально приспособлено
для аппаратной реализации и удачно согласовано со зрительной системой
человека в том смысле, что человеческий глаз восприимчив к красному,
зеленому и синему /emdash.cyr первичным основным цветам. Но пространство RGB
плохо приспособлено для описания цветов так, как это свойственно чело-
веку. Например, описывая цвет автомобиля, мы не говорим о процентном
содержании в нем красного, зелёного и синего. И рассматривая цветное
изображение мы не думаем о том, что оно составлено из трёх отдельных
изображений /emdash.cyr по одному для каждого первичного основного цвета. Глядя
на окрашенный объект, человек описывает его с помощью цветового тона,
насыщенности и светлоты.
Пространство HSI и другие схожие пространства позволяют отделить
информацию о цветности (тон и насыщенность) от информации о яркости
(интенсивность). Поскольку в основе модели лежит естественное и интуи-
тивно близкое человеку описание цвета, пространство HSI часто использо-
валось для построения алгоритмов обработки изображений.
28
HSI/HSL/HSV/HSB Всепространстваэтогосемействамогутбытьпред-
ставлены, как геометрическое преобразование RGB куба. Если поставить
RGB куб на угол, соответствующий черному цвету с осью-диагональю от
черного к белому, то тогда насыщенность можно измерять, как расстояние
отэтойоси-чемдальшеотоси,темнасыщеннеецвет.Ацветовойтонможно
измерять как угол вокруг этой оси, начиная с угла в0◦, соответствующего
красному цвету. Основное отличие всех пространств этого семейства лежит
в определении яркостной составляющей. Интенсивность I в пространстве
HSI определяется как среднее арифметическое R, G и B координат в исход-
ном пространстве RGB. Светлота L (lightness) в пространстве HSL опреде-
ляется, как среднее арифметическое максимума и минимума значений R,
G, B. Значение V (value) определяется как максимум R, G, B.
CIE Lab Цветовое пространство XYZ (или, что тоже самое, диаграмма
цветностей МКО) вмещает в себя все воспринимаемые человеком цвета. Но
данное пространство нелинейно, или, иными словами, зрительно неодно-
родно. Это значит, что два равноудалённых цвета от некоторой точки в
данном пространстве необязательно будут восприниматься зрительно как
равноудалённые от цвета, соответствующего этой некоторой точке. Было
предпринято несколько попыток устранить нелинейность XYZ. В итоге в
1976 году была разработана модель CIE L*a*b*, которая является сейчас
международным стандартом.
В цветовом пространстве Lab значение светлоты отделено от значения
хроматической составляющей цвета (тон, насыщенность). Светлота задана
координатой L (изменяется от 0 до 100, то есть от самого тёмного до самого
светлого), хроматическая составляющая /emdash.cyr двумя декартовыми координа-
тами a и b. Первая обозначает положение цвета в диапазоне от зелёного до
красного, вторая /emdash.cyr от синего до жёлтого.
В отличие от цветовых пространств RGB или CMYK, которые явля-
ются, по сути, набором аппаратных данных для воспроизведения цвета на
бумаге или на экране монитора, и в которых цвет может зависеть от типа
печатной машины или марки красок, или производителя монитора и его
настроек, CIE Lab однозначно определяет цвет. Поэтому данное простран-
ство нашло широкое применение в программном обеспечении для обработ-
ки изображений в качестве промежуточного цветового пространства, через
которое происходит конвертирование данных между другими цветовыми
пространствами. Помимо этого, особые свойства Lab сделали редактирова-
ние в этом пространстве мощным инструментом цветокоррекции. Благода-
ря характеру определения цвета в Lab появляется возможность отдельно
воздействовать на яркость, контраст изображения и на его цвет. Во многих
случаяхэтопозволяетускоритьобработкуизображений.Labпредоставляет
возможность избирательного воздействия на отдельные цвета в изображе-
нии, усиления цветового контраста.
29
HCL И ещё одним цветовым пространством, которое мы кратко упомя-
нем, является пространство HCL. Это пространство было создано, чтобы
совместить в себе свойства пространств, полученных при помощи цилин-
дрических преобразований RGB (пространств семейства HSI) и свойства
линейности цвета пространства CIE Lab.
Представление цифровых изображенийКак же компьютер пред-
ставляет и хранит цветное изображение? Ранее мы говорили, что моно-
хромное черно-белое растровое изображение представляет собой матрицу,
в которой значение каждого элемента соответствует уровню яркости, или
интенсивности, соответствующего пикселя.
Представление цветного изображенияДля хранения информации о
цвете изображения нам необходимо хранить информацию о цвете каждого
пикселя. Поскольку большинство цветовых пространств позволяет задать
цвет при помощи трёх координат, цветное растровое изображение будет
хранить значения трёх цветовых координат для каждого пикселя. Так, при
представлении изображения в пространстве RGB, для каждого пикселя бу-
дет хранится значения красной, зелёной и синей составляющих данного
цвета. Т.е. цветное изображение, в отличие от монохромного, может быть
представлено трехмерным тензором, в котором одна из размерностей соот-
ветствует координатам цвета (или цветовым каналам).
30
